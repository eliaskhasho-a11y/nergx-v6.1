import { addNotif } from './state.js';import { CONFIG } from './config.js';let ws;export function initRealtime(){if(CONFIG.WEBSOCKET_URL){try{ws=new WebSocket(CONFIG.WEBSOCKET_URL);ws.onopen=()=>addNotif('Realtime ansluten','success');ws.onmessage=(ev)=>{try{const msg=JSON.parse(ev.data);document.dispatchEvent(new CustomEvent('rt:event',{detail:msg}))}catch(e){}};ws.onerror=()=>addNotif('Realtime fel – växlar till mock','warning');ws.onclose=()=>addNotif('Realtime stängd','warning')}catch(e){addNotif('Realtime kunde inte starta (URL ogiltig) – mock används','warning')}}else{setInterval(()=>{document.dispatchEvent(new CustomEvent('rt:event',{detail:{type:'order.created',ref:'#M-10023',at:Date.now()}}))},20000)}}