import { addNotif } from '../state.js';import { CONFIG } from '../config.js';export function mountCoach(){const log=document.getElementById('coachLog');const form=document.getElementById('coachForm');const input=document.getElementById('coachInput');function push(role,text){const el=document.createElement('div');el.className='msg '+role;el.innerHTML=`<strong>${role==='ai'?'AI':'Du'}:</strong> ${text}`;log.appendChild(el);log.scrollTop=log.scrollHeight}push('ai','Hej! Jag är din AI-coach. Jag bevakar KPI:er, lager och deadlines. Säg vad du vill ha hjälp med.');form.addEventListener('submit',async(ev)=>{ev.preventDefault();const q=input.value.trim();if(!q)return;push('you',q);input.value='';try{const resp=await fetch(CONFIG.OPENAI_ENDPOINT,{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({prompt:q})});const data=await resp.json();push('ai',data?.reply||'AI (mock): Jag kunde inte få svar.');addNotif('AI svar mottaget','info')}catch(e){setTimeout(()=>{push('ai','Mock: Förslag – öka lagret för CAR-CHG-60W och skicka kampanj till Region Stockholm.')},500)}})}