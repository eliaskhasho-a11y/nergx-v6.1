<!DOCTYPE html>
<html lang="sv">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>MergX v8.21 â€” Admin</title>

  <!-- Glass tema / app CSS -->
  <link rel="stylesheet" href="css/app.css" />

  <!-- Ikoner (valfritt, fÃ¶r smÃ¥ symboler) -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">

  <!-- Leaflet fÃ¶r AI-karta -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/leaflet@1.9.4/dist/leaflet.css" />
  <script defer src="https://cdn.jsdelivr.net/npm/leaflet@1.9.4/dist/leaflet.js"></script>

  <!-- Chart.js fÃ¶r ekonomi-graf -->
  <script defer src="https://cdn.jsdelivr.net/npm/chart.js@4.4.1/dist/chart.umd.min.js"></script>

  <!-- App JS -->
  <script defer src="js/app.js"></script>
</head>
<body>
  <aside class="sidebar" id="sidebar">
    <div class="brand">
      <div class="logo">X</div>
      <div class="brand-meta">
        <div class="brand-title">MergX Admin</div>
        <div class="brand-sub">v8.21 â€¢ Light + Glass</div>
      </div>
      <button class="hamburger" id="menuToggle" aria-label="Meny">â˜°</button>
    </div>

    <nav class="nav">
      <button class="nav-item active" data-route="dashboard">Ã–versikt</button>
      <button class="nav-item" data-route="orders">Ordrar & fakturor</button>
      <button class="nav-item" data-route="customers">Kunder (CRM)</button>
      <button class="nav-item" data-route="inventory">Inventarie</button>
      <button class="nav-item" data-route="employees">AnstÃ¤llda</button>
      <button class="nav-item" data-route="files">Filer & kvitton</button>
      <button class="nav-item" data-route="aimap">AI-karta</button>
      <button class="nav-item" data-route="chat">Chatt</button>
      <button class="nav-item" data-route="settings">InstÃ¤llningar</button>
    </nav>
  </aside>

  <main class="main">
    <header class="topbar glass">
      <input class="search" id="globalSearch" placeholder="SÃ¶k i MergXâ€¦ (kunder, order, produkter)" />
      <div class="topbar-actions">
        <button class="btn" id="gotoDashboard">GÃ¥ till Ã–versikt</button>
      </div>
    </header>

    <!-- ROUTER-YTA -->
    <section id="view"></section>
  </main>

  <!-- ======= TEMPLATES ======= -->
  <!-- DASHBOARD -->
  <template id="view-dashboard">
    <div class="grid gap">
      <!-- KPI-kort -->
      <div class="kpi-grid">
        <button class="kpi glass" data-expand="oms">
          <div class="kpi-title">OmsÃ¤ttning (idag)</div>
          <div class="kpi-value" id="kpi-oms">124 500 kr</div>
          <div class="kpi-trend kpi-up">+6.2%</div>
        </button>
        <button class="kpi glass" data-expand="ord">
          <div class="kpi-title">Order idag</div>
          <div class="kpi-value" id="kpi-ord">37</div>
          <div class="kpi-trend kpi-up">+4</div>
        </button>
        <button class="kpi glass" data-expand="kost">
          <div class="kpi-title">Kostnader (idag)</div>
          <div class="kpi-value" id="kpi-kost">48 900 kr</div>
          <div class="kpi-trend kpi-down">âˆ’2.1%</div>
        </button>
        <button class="kpi glass" data-expand="gm">
          <div class="kpi-title">Bruttomarginal</div>
          <div class="kpi-value" id="kpi-gm">41.5%</div>
          <div class="kpi-trend kpi-up">+0.7 pp</div>
        </button>
      </div>

      <!-- Ekonomi graf -->
      <div class="card glass">
        <div class="card-head">
          <h3>Ekonomi â€” kombostaplar</h3>
          <div class="head-actions">
            <button class="btn secondary" data-ask="economy">Ask AI</button>
            <button class="btn" data-expand="economy">Expandera</button>
          </div>
        </div>
        <div class="card-body full-bleed">
          <canvas id="ecoChart"></canvas>
        </div>
      </div>

      <!-- AI-karta (mini) -->
      <div class="card glass">
        <div class="card-head">
          <h3>AI-karta (mini)</h3>
          <div class="head-actions">
            <button class="btn secondary" data-ask="map">Ask AI</button>
            <button class="btn" data-expand="map">Expandera</button>
          </div>
        </div>
        <div class="card-body">
          <div id="miniMap" class="map"></div>
          <div class="hint">AI-rekommendationer: â€œBesÃ¶k <b>Elon Kista â†’ Power Solna â†’ Mekonomen Bromma</b>. Totalt ca 43 min.â€</div>
        </div>
      </div>

      <!-- Teamchatt -->
      <div class="card glass">
        <div class="card-head">
          <h3>Teamchatt</h3>
          <div class="head-actions">
            <button class="btn secondary" data-ask="chat">Ask AI</button>
            <button class="btn" data-expand="chat">Expandera</button>
          </div>
        </div>
        <div class="card-body">
          <div class="chat-window" id="chatWindow">
            <div class="bubble bubble-left">God morgon teamet!</div>
            <div class="bubble bubble-right">Jag tar kundmÃ¶tet 11:00.</div>
          </div>
          <div class="chat-actions">
            <label class="icon-btn" title="Bifoga filer">
              ğŸ“ <input type="file" id="chatFile" hidden>
            </label>
            <button class="icon-btn" id="recBtn" title="Spela in rÃ¶st">ğŸ™ï¸</button>
            <input id="chatInput" class="chat-input" placeholder="Skriv ett meddelandeâ€¦ (Enter fÃ¶r att skicka)" />
            <button id="chatSend" class="btn">Skicka</button>
          </div>
          <div class="hint">RÃ¶stinspelning sparas lokalt som mock och kan AI-sammanfattas per kund i kommande version.</div>
        </div>
      </div>
    </div>
  </template>

  <!-- Ã–VRIGA VYER (plats fÃ¶r framtida funktioner, klickbara nu) -->
  <template id="view-placeholder">
    <div class="card glass">
      <div class="card-head">
        <h3 id="ph-title">Titel</h3>
      </div>
      <div class="card-body">
        <p>Detta Ã¤r en fÃ¶rberedd vy. HÃ¤r lÃ¤gger vi riktig funktionalitet i nÃ¤sta steg utan att Ã¤ndra grund.</p>
        <ul class="bullets">
          <li>Klickbar tabell (mock)</li>
          <li>Filter/search i topp</li>
          <li>â€œAsk AIâ€ fÃ¶r snabb analys</li>
        </ul>
      </div>
    </div>
  </template>

  <!-- EXPAND OVERLAY -->
  <div id="overlay" class="overlay hidden" role="dialog" aria-modal="true">
    <div class="overlay-inner glass">
      <div class="overlay-head">
        <h3 id="overlayTitle">Analys</h3>
        <div class="head-actions">
          <button class="btn secondary" id="overlayAsk">Ask AI</button>
          <button class="btn" id="overlayClose">StÃ¤ng</button>
        </div>
      </div>
      <div class="overlay-body" id="overlayBody">
        <!-- InnehÃ¥ll fylls dynamiskt -->
      </div>
    </div>
  </div>
</body>
</html>
